<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Quantum Coordinate Decoder</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --bg: #f9fbfd;
      --fg: #1a1a2e;
      --card-bg: #ffffff;
      --input-bg: #f0f5ff;
      --input-fg: #1a1a2e;
      --error: #e63946;
      --accent: #4361ee;
      --accent-hover: #3a56d4;
      --success: #2a9d8f;
      --divider: #e0e7ff;
      --shadow: rgba(67, 97, 238, 0.15);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    body.dark {
      --bg: #0f172a;
      --fg: #e2e8f0;
      --card-bg: #1e293b;
      --input-bg: #334155;
      --input-fg: #e2e8f0;
      --divider: #334155;
      --shadow: rgba(15, 23, 42, 0.8);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: var(--bg);
      color: var(--fg);
      font-family: 'Segoe UI', 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
      line-height: 1.6;
      padding: 1.5rem;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .container {
      max-width: 1000px;
      width: 100%;
    }

    header {
      text-align: center;
      margin-bottom: 2.5rem;
      position: relative;
      padding-top: 1rem;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, #4361ee, #3a0ca3);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      letter-spacing: -0.5px;
    }

    .subtitle {
      font-size: 1.1rem;
      color: #64748b;
      max-width: 600px;
      margin: 0 auto;
    }

    .card {
      background: var(--card-bg);
      border-radius: 16px;
      box-shadow: 0 8px 30px var(--shadow);
      padding: 2rem;
      margin-bottom: 2rem;
      transition: var(--transition);
    }

    .card-title {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
      color: var(--accent);
    }

    .card-title i {
      font-size: 1.2rem;
      background: rgba(67, 97, 238, 0.1);
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .section-divider {
      height: 1px;
      background: var(--divider);
      margin: 1.5rem 0;
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .pair {
      flex: 1;
      min-width: 220px;
      background: rgba(67, 97, 238, 0.05);
      border-radius: 12px;
      padding: 1.2rem;
      transition: var(--transition);
      border: 1px solid var(--divider);
    }

    .pair:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(67, 97, 238, 0.1);
    }

    .pair-title {
      font-weight: 600;
      margin-bottom: 0.8rem;
      color: var(--accent);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .pair-title i {
      font-size: 0.9rem;
    }

    .field {
      margin-bottom: 1rem;
    }

    label {
      display: block;
      font-size: 0.9rem;
      font-weight: 500;
      margin-bottom: 0.4rem;
      color: #64748b;
    }

    .input-group {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .input-group span {
      font-weight: 500;
      color: var(--accent);
    }

    input[type="number"] {
      width: 100%;
      padding: 0.8rem 1rem;
      border: 1px solid var(--divider);
      border-radius: 10px;
      background: var(--input-bg);
      color: var(--input-fg);
      font-size: 1rem;
      transition: var(--transition);
    }

    input[type="number"]:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }

    .btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 0.9rem 1.8rem;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: var(--transition);
      box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
    }

    .btn:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(67, 97, 238, 0.4);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn-outline {
      background: transparent;
      color: var(--accent);
      border: 1px solid var(--accent);
      box-shadow: none;
    }

    .btn-outline:hover {
      background: rgba(67, 97, 238, 0.1);
    }

    .btn-success {
      background: var(--success);
      box-shadow: 0 4px 12px rgba(42, 157, 143, 0.3);
    }

    .btn-success:hover {
      background: #249284;
      box-shadow: 0 6px 15px rgba(42, 157, 143, 0.4);
    }

    .error {
      color: var(--error);
      font-size: 0.9rem;
      margin-top: 0.8rem;
      padding: 0.8rem;
      background: rgba(230, 57, 70, 0.1);
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .output {
      background: rgba(67, 97, 238, 0.05);
      padding: 1.5rem;
      border-radius: 12px;
      margin-top: 1.5rem;
      border: 1px dashed var(--accent);
    }

    .output-title {
      font-weight: 600;
      margin-bottom: 0.8rem;
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--accent);
    }

    .constants-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-top: 1rem;
    }

    .constant-item {
      background: rgba(67, 97, 238, 0.08);
      border-radius: 10px;
      padding: 1rem;
      text-align: center;
    }

    .constant-label {
      font-size: 0.9rem;
      color: #64748b;
      margin-bottom: 0.5rem;
    }

    .constant-value {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Courier New', monospace;
      color: var(--accent);
    }

    .decoded-output {
      display: flex;
      gap: 2rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    .coordinate {
      text-align: center;
      flex: 1;
      min-width: 120px;
    }

    .coordinate-label {
      font-weight: 500;
      color: #64748b;
      margin-bottom: 0.5rem;
    }

    .coordinate-value {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Courier New', monospace;
      color: var(--success);
      background: rgba(42, 157, 143, 0.1);
      padding: 0.8rem;
      border-radius: 10px;
    }

    .toggle-theme {
      position: absolute;
      top: 0;
      right: 0;
      background: var(--card-bg);
      border: 1px solid var(--divider);
      border-radius: 50%;
      color: var(--fg);
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 4px 10px var(--shadow);
    }

    .toggle-theme:hover {
      transform: rotate(15deg);
      background: var(--accent);
      color: white;
    }

    .hidden {
      display: none;
    }

    @media (max-width: 768px) {
      .row {
        flex-direction: column;
      }

      .pair {
        min-width: 100%;
      }

      .decoded-output {
        flex-direction: column;
        gap: 1rem;
      }

      h1 {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><i class="fas fa-atom"></i> Telescience Coordinate Decoder</h1>
      <p class="subtitle">Calculate your conversion constants from sample mappings, then convert any new coordinates.</p>
      <div class="toggle-theme" title="Toggle theme">
        <i class="fas fa-moon"></i>
      </div>
    </header>

    <main>
      <!-- Sample Inputs Section -->
      <div class="card">
        <h2 class="card-title"><i class="fas fa-vial"></i> Sample Mappings</h2>
        <p>Provide <strong>two</strong> True→Telesci coordinate pairs for X &amp; Y, plus <strong>one</strong> for Z.</p>

        <div class="section-divider"></div>

        <!-- X Coordinates Section -->
        <div class="row">
          <div class="pair">
            <h3 class="pair-title"><i class="fas fa-xmark"></i> X Sample #1</h3>
            <div class="field">
              <label>True X (“T.x₁”)</label>
              <input type="number" step="any" id="Tx1" placeholder="Actual X map coords (from map or space GPS)">
            </div>
            <div class="field">
              <label>Telesci X (“tx₁”)</label>
              <input type="number" step="any" id="tx1" placeholder="Telesci X₁">
            </div>
          </div>

          <div class="pair">
            <h3 class="pair-title"><i class="fas fa-xmark"></i> X Sample #2</h3>
            <div class="field">
              <label>True X (“T.x₂”)</label>
              <input type="number" step="any" id="Tx2" placeholder="Actual X map coords (from map or space GPS)">
            </div>
            <div class="field">
              <label>Telesci X (“tx₂”)</label>
              <input type="number" step="any" id="tx2" placeholder="Telesci X₂">
            </div>
          </div>
        </div>

        <!-- Y Coordinates Section -->
        <div class="row">
          <div class="pair">
            <h3 class="pair-title"><i class="fas fa-yin-yang"></i> Y Sample #1</h3>
            <div class="field">
              <label>True Y (“T.y₁”)</label>
              <input type="number" step="any" id="Ty1" placeholder="Actual Y map coords (from map or space GPS)">
            </div>
            <div class="field">
              <label>Telesci Y (“ty₁”)</label>
              <input type="number" step="any" id="ty1" placeholder="Telesci Y₁">
            </div>
          </div>

          <div class="pair">
            <h3 class="pair-title"><i class="fas fa-yin-yang"></i> Y Sample #2</h3>
            <div class="field">
              <label>True Y (“T.y₂”)</label>
              <input type="number" step="any" id="Ty2" placeholder="Actual Y map coords (from map or space GPS)">
            </div>
            <div class="field">
              <label>Telesci Y (“ty₂”)</label>
              <input type="number" step="any" id="ty2" placeholder="Telesci Y₂">
            </div>
          </div>
        </div>

        <!-- Z Coordinates Section -->
        <div class="row">
          <div class="pair">
            <h3 class="pair-title"><i class="fas fa-arrows-up-down"></i> Z Sample</h3>
            <div class="field">
              <label>True Z (“T.z”)</label>
              <input type="number" step="any" id="Tz" placeholder="Station = 1. Azone = 2. Debris = 3. Aestroid = 5">
            </div>
            <div class="field">
              <label>Telesci.z</label>
              <input type="number" step="any" id="tz" placeholder="Telesci Z">
            </div>
          </div>
        </div>

        <div id="sample-error" class="error hidden">
          <i class="fas fa-exclamation-circle"></i>
          <span></span>
        </div>

        <button class="btn" id="compute-btn">
          <i class="fas fa-calculator"></i> Compute Constants
        </button>
      </div>

      <!-- Constants Section -->
      <div class="card" id="constants-card" style="display: none;">
        <h2 class="card-title"><i class="fas fa-cogs"></i> Derived Constants</h2>
        <p>Conversion constants calculated from your sample pairs:</p>

        <button class="btn btn-outline" id="toggle-constants">
          <i class="fas fa-eye"></i> Show Constants
        </button>

        <div class="output" id="constants" style="display: none;">
          <div class="constants-grid">
            <div class="constant-item">
              <div class="constant-label">XSUBTRACT</div>
              <div class="constant-value" id="XSUB">0.0000</div>
            </div>
            <div class="constant-item">
              <div class="constant-label">XMULTIPLY</div>
              <div class="constant-value" id="XMULT">0.0000</div>
            </div>
            <div class="constant-item">
              <div class="constant-label">YSUBTRACT</div>
              <div class="constant-value" id="YSUB">0.0000</div>
            </div>
            <div class="constant-item">
              <div class="constant-label">YMULTIPLY</div>
              <div class="constant-value" id="YMULT">0.0000</div>
            </div>
            <div class="constant-item">
              <div class="constant-label">ZSUBTRACT</div>
              <div class="constant-value" id="ZSUB">0.0000</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Decode Section -->
      <div class="card" id="decode-section" style="display: none;">
        <h2 class="card-title"><i class="fas fa-bolt"></i> Decode Coordinates</h2>
        <p>Enter True coordinates to convert to Telesci coordinates:</p>

        <div class="row">
          <div class="field">
            <label>True.x</label>
            <input type="number" step="any" id="dx" placeholder="Enter True.x">
          </div>
          <div class="field">
            <label>True.y</label>
            <input type="number" step="any" id="dy" placeholder="Enter True.y">
          </div>
          <div class="field">
            <label>True.z</label>
            <input type="number" step="any" id="dz" placeholder="Enter True.z">
          </div>
        </div>

        <div id="decode-error" class="error hidden">
          <i class="fas fa-exclamation-circle"></i>
          <span></span>
        </div>

        <button class="btn btn-success" id="decode-btn">
          <i class="fas fa-bolt"></i> Decode Coordinates
        </button>

        <div class="output" id="decoded" style="display: none;">
          <div class="output-title">
            <i class="fas fa-map-marker-alt"></i> Telesci Coordinates
          </div>
          <div class="decoded-output">
            <div class="coordinate">
              <div class="coordinate-label">tx</div>
              <div class="coordinate-value" id="outx">0.0000</div>
            </div>
            <div class="coordinate">
              <div class="coordinate-label">ty</div>
              <div class="coordinate-value" id="outy">0.0000</div>
            </div>
            <div class="coordinate">
              <div class="coordinate-label">tz</div>
              <div class="coordinate-value" id="outz">0.0000</div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    // Theme toggle
    const toggle = document.querySelector('.toggle-theme');
    const themeIcon = toggle.querySelector('i');

    toggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      if (document.body.classList.contains('dark')) {
        themeIcon.classList.remove('fa-moon');
        themeIcon.classList.add('fa-sun');
      } else {
        themeIcon.classList.remove('fa-sun');
        themeIcon.classList.add('fa-moon');
      }
    });

    // Helpers
    const $ = id => document.getElementById(id);
    const isNum = v => !isNaN(v) && v !== '';
    const showError = (element, message) => {
      element.classList.remove('hidden');
      element.querySelector('span').textContent = message;
    };
    const hideError = (element) => {
      element.classList.add('hidden');
    };

    // Toggle constants visibility
    const toggleConstantsBtn = $('toggle-constants');
    toggleConstantsBtn.addEventListener('click', () => {
      const constants = $('constants');
      if (constants.style.display === 'none') {
        constants.style.display = 'block';
        toggleConstantsBtn.innerHTML = '<i class="fas fa-eye-slash"></i> Hide Constants';
      } else {
        constants.style.display = 'none';
        toggleConstantsBtn.innerHTML = '<i class="fas fa-eye"></i> Show Constants';
      }
    });

    // Compute constants
    $('compute-btn').addEventListener('click', () => {
      const Tx1 = parseFloat($('Tx1').value),
            tx1 = parseFloat($('tx1').value),
            Tx2 = parseFloat($('Tx2').value),
            tx2 = parseFloat($('tx2').value),
            Ty1 = parseFloat($('Ty1').value),
            ty1 = parseFloat($('ty1').value),
            Ty2 = parseFloat($('Ty2').value),
            ty2 = parseFloat($('ty2').value),
            Tz  = parseFloat($('Tz').value),
            tz  = parseFloat($('tz').value);

      const err = $('sample-error');
      hideError(err);

      // Validate numeric
      if (![Tx1,tx1,Tx2,tx2,Ty1,ty1,Ty2,ty2,Tz,tz].every(isNum)) {
        showError(err, 'All sample fields must contain numeric values.');
        return;
      }

      // Validate degenerate
      if (tx1 === tx2) {
        showError(err, 'Error: tx₁ and tx₂ must have different values.');
        return;
      }
      if (ty1 === ty2) {
        showError(err, 'Error: ty₁ and ty₂ must have different values.');
        return;
      }

      // Compute
      const XMULT = (Tx1 - Tx2) / (tx1 - tx2);
      const XSUB  = tx1 * XMULT - Tx1;
      const YMULT = (Ty1 - Ty2) / (ty1 - ty2);
      const YSUB  = ty1 * YMULT - Ty1;
      const ZSUB  = tz - Tz;

      // Display rounded to 4 decimals
      $('XSUB').textContent = XSUB.toFixed(4);
      $('XMULT').textContent = XMULT.toFixed(4);
      $('YSUB').textContent = YSUB.toFixed(4);
      $('YMULT').textContent = YMULT.toFixed(4);
      $('ZSUB').textContent = ZSUB.toFixed(4);

      // Show constants section and hide toggle text
      $('constants-card').style.display = 'block';
      $('toggle-constants').innerHTML = '<i class="fas fa-eye"></i> Show Constants';
      $('constants').style.display = 'none';

      // Show decode section
      $('decode-section').style.display = 'block';
      $('decoded').style.display = 'none';
      hideError($('decode-error'));
    });

    // Decode new coordinates
    $('decode-btn').addEventListener('click', () => {
      const XSUB  = parseFloat($('XSUB').textContent),
            XMULT = parseFloat($('XMULT').textContent),
            YSUB  = parseFloat($('YSUB').textContent),
            YMULT = parseFloat($('YMULT').textContent),
            ZSUB  = parseFloat($('ZSUB').textContent),
            dx    = parseFloat($('dx').value),
            dy    = parseFloat($('dy').value),
            dz    = parseFloat($('dz').value);

      const err = $('decode-error');
      hideError(err);

      if (![dx,dy,dz].every(isNum)) {
        showError(err, 'Please enter numeric True.x, True.y, and True.z values to decode.');
        return;
      }

      const outx = (dx + XSUB)/XMULT;
      const outy = (dy + YSUB)/YMULT;
      const outz = dz + ZSUB;

      $('outx').textContent = outx.toFixed(4);
      $('outy').textContent = outy.toFixed(4);
      $('outz').textContent = outz.toFixed(4);
      $('decoded').style.display = 'block';
    });
  </script>
</body>
</html>
